<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>部屋の明暗表示</title>
<style>
  .room {
    display: inline-block;
    width: 80px;
    height: 80px;
    margin: 5px;
    text-align: center;
    font-family: sans-serif;
    border-radius: 5px;
    color: white;
    vertical-align: top;
    padding-top: 10px;
  }
  .bright { background-color: green; }
  .dark { background-color: black; }
  .other { background-color: gray; }
  .room-number {
    font-weight: bold;
    margin-bottom: 5px;
  }
  .room-status {
    font-weight: bold;
  }
</style>
<!-- Firebase v8 SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
</head>
<body>
<h1>部屋の明暗表示</h1>
<div id="roomsContainer"></div>

<script>
// ==== Firebase 初期化 ====
const firebaseConfig = {
  apiKey: "AIzaSyAt9FoenejYFhDIDZg5BTYfcl0x-czJ4v4",
  authDomain: "server-f5ca2.firebaseapp.com",
  databaseURL: "https://server-f5ca2-default-rtdb.firebaseio.com",
  projectId: "server-f5ca2",
  storageBucket: "server-f5ca2.firebasestorage.app",
  messagingSenderId: "911418656641",
  appId: "1:911418656641:web:00d6d168eba14ebf984a80",
};
firebase.initializeApp(firebaseConfig);
const database = firebase.database();

const container = document.getElementById('roomsContainer');

// Firebase 最新データ監視
database.ref('rooms').orderByKey().limitToLast(1).on('value', snapshot => {
  container.innerHTML = ''; // 前の表示をクリア
  const roomsData = snapshot.val();
  if (!roomsData) return;

  const key = Object.keys(roomsData)[0];
  const data = roomsData[key];

  for (let i = 1; i <= 18; i++) {
    const roomKey = "room" + i;
    const val = data[roomKey];

    const div = document.createElement('div');
    div.classList.add('room');

    // 状態に応じて色と文字を切り替え
    let statusText;
    if (val === 1) {
      div.classList.add('bright');
      statusText = "明るい";
    } else if (val === 2) {
      div.classList.add('dark');
      statusText = "暗い";
    } else {
      div.classList.add('other');
      statusText = val;
    }

    // 部屋番号と状態を別行で表示
    const roomNumber = document.createElement('div');
    roomNumber.classList.add('room-number');
    roomNumber.textContent = roomKey;

    const roomStatus = document.createElement('div');
    roomStatus.classList.add('room-status');
    roomStatus.textContent = statusText;

    div.appendChild(roomNumber);
    div.appendChild(roomStatus);
    container.appendChild(div);
  }
});
</script>
</body>
</html>
